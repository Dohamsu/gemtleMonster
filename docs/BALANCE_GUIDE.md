# 🎮 GemtleMonster 게임 시스템 밸런싱 문서

## 📊 1. 플레이어/몬스터 레벨 시스템

### 1.1 연금술 레벨 (플레이어)

**공식**: `레벨 = floor(총 경험치 / 100) + 1`

| 레벨 | 필요 누적 EXP | 증분 |
|-----|-------------|------|
| 1 | 0 | - |
| 2 | 100 | 100 |
| 3 | 200 | 100 |
| 5 | 400 | 100 |
| 10 | 900 | 100 |

> 💡 연금술 레벨은 **고정 100 EXP/레벨**로 단순 선형 성장

---

### 1.2 몬스터 레벨

**필요 경험치 공식**: `(레벨 × 50 + 레벨² × 3) × 레어도 배율`

| 레어도 | 최대 레벨 | EXP 배율 | 스탯 성장률 |
|-------|---------|---------|-----------|
| N | 30 | ×1.0 | ×1.0 |
| R | 50 | ×1.2 | ×1.15 |
| SR | 70 | ×1.5 | ×1.3 |
| SSR | 99 | ×2.0 | ×1.5 |

**레벨별 필요 EXP (N등급 기준)**:

| 레벨 | 필요 EXP | 누적 EXP |
|-----|---------|---------|
| 1→2 | 53 | 53 |
| 5→6 | 325 | 1,075 |
| 10→11 | 830 | 4,290 |
| 20→21 | 2,200 | 21,400 |
| 30→31 | 4,200 | - (N 최대) |

---

## 🎯 2. 경험치 획득원

### 2.1 메인 경험치 소스

| 출처 | EXP 범위 | 메인 여부 | 비고 |
|-----|---------|---------|------|
| **던전 전투** | 10~1000 | ⭐ 메인 | 몬스터 경험치 |
| **연금술 성공** | 10~200 | ⭐ 메인 | 연금술 경험치 |
| 연금술 실패 | 3~60 | 서브 | 재료 등급 × 30% |
| 퀘스트 | - | 미구현 | - |

### 2.2 연금술 경험치 획득

**성공 시**: 레시피별 고정 EXP (10~200)
**실패 시**: 재료 등급 합산 × 30%

| 재료 등급 | EXP/개 |
|---------|--------|
| N | 10 |
| R | 20 |
| SR | 30 |
| SSR | 50 |

---

## ⚔️ 3. 전투 데미지 공식

### 3.1 데미지 계산 (`battleUtils.ts`)

```typescript
// 1. 기본 데미지
damage = ATK × (스킬배율 / 100)

// 2. 속성 배율
damage × 속성배율

// 3. DEF 감쇄 (핵심!)
damage = max(1, damage - DEF × 0.5)

// 4. 치명타 (10% 확률, 1.5배)
// 5. 분산 (90%~110% 랜덤)
```

### 3.2 DEF 영향 분석

| DEF | 감쇄량 | ATK 100 기준 데미지 |
|-----|-------|------------------|
| 0 | 0 | 90~110 |
| 30 | 15 | 75~95 |
| 60 | 30 | 60~80 |
| 80 | 40 | 50~70 |

> ⚠️ **문제**: DEF 0 vs 80일 때 데미지 차이가 약 1.5배 → TTK(처치 시간) 최대 1.5~2배 차이

### 3.3 속성 상성

| 관계 | 배율 |
|-----|-----|
| 유리 | ×1.3 |
| 불리 | ×0.8 |
| 동등 | ×1.0 |

```
Fire > Earth > Wind > Water > Fire
Light <-> Dark (상호 유리)
```

---

## 📦 4. 던전 드랍 테이블

### 4.1 슬라임 숲 (권장 Lv.1)

| 적 | HP | EXP | 드랍 | 확률 | 수량 | 평균 |
|---|---|----|-----|-----|-----|-----|
| 초록 슬라임 | 30 | 10000⚠️ | slime_fluid | 80% | 1~2 | 1.2 |
| | | | herb_common | 40% | 1 | 0.4 |
| | | | beast_fang | 25% | 1 | 0.25 |
| | | | shard_earth | 15% | 1 | 0.15 |
| 파랑 슬라임 | 50 | 20 | slime_fluid | 90% | 1~3 | 1.8 |
| | | | slime_core | 20% | 1 | 0.2 |
| 킹 슬라임 | 200 | 100 | slime_core | 100% | 1~2 | 1.5 |
| | | | gem_fragment | 50% | 1 | 0.5 |

### 4.2 화산 요새 (권장 Lv.20)

| 적 | HP | EXP | 드랍 | 확률 | 수량 | 평균 |
|---|---|----|-----|-----|-----|-----|
| 파이어 슬라임 | 600 | 250 | slime_fluid | 80% | 3~5 | 3.2 |
| | | | ore_iron | 40% | 2~4 | 1.2 |
| | | | shard_fire | 30% | 1 | 0.3 |
| 마그마 골렘 | 1000 | 400 | ore_iron | 100% | 3~6 | 4.5 |
| | | | fire_core | 20% | 1 | 0.2 |
| 인페르노 드래곤 | 2000 | 1000 | dragon_scale | 100% | 1~2 | 1.5 |
| | | | dragon_horn | 50% | 1 | 0.5 |
| | | | fire_core | 40% | 1 | 0.4 |

### 4.3 평균 드랍 가치 추정

슬라임 숲 1판 (초록 슬라임 기준):
- slime_fluid: 1.2개 × 5G = 6G
- herb_common: 0.4개 × 10G = 4G
- **총 기대값: ~12G/판**

화산 요새 1판 (마그마 골렘 기준):
- ore_iron: 4.5개 × 15G = 67.5G
- fire_core: 0.2개 × 500G = 100G
- **총 기대값: ~200G/판**

---

## 🏭 5. 시설 생산 및 소모량 분석

### 5.1 시설 생산 속도

| 시설 | 레벨 | 간격 | 주요 생산 | 분당 생산량 |
|-----|-----|-----|---------|----------|
| 약초 농장 | 1 | 10초 | herb_common | 6개/분 |
| 약초 농장 | 2 | 8초 | herb_common | 6개/분 (rare 1.5개) |
| 광산 | 1 | 15초 | stone | 3.6개/분 (iron 0.4개) |
| 광산 | 3 | 10초 | ore_iron | 4.8개/분 |
| 대장간 | 1 | 20초 | ingot_copper | 3개/분 |

### 5.2 레시피 소모량 vs 생산량

| 레시피 | 재료 | 필요량 | 생산 시간 | 병목 여부 |
|-------|-----|-------|---------|---------|
| 기본 슬라임 | herb_common | 2개 | 약초농장 Lv.1: 20초 | ❌ 여유 |
| 돌 골렘 | stone | 10개 | 광산 Lv.1: 2분 47초 | ⚠️ 병목 |
| | ore_iron | 1개 | 광산 Lv.1: 2분 30초 | ⚠️ 병목 |
| 인페르노 드래곤 | ore_mythril | 5개 | 광산에서 미생산 | 🚨 던전 의존 |

### 5.3 초반 병목 분석

**기본 슬라임 대량 생산 시나리오**:
- 목표: 1시간에 슬라임 10마리
- 필요: herb_common 20개
- 약초농장 Lv.1 생산: 6개/분 × 60분 = 360개
- **결론**: ✅ 충분 (생산 여력 18배)

**돌 골렘 생산 시나리오**:
- 목표: 1시간에 골렘 3마리
- 필요: stone 30개, ore_iron 3개
- 광산 Lv.1 생산: stone 216개, ore_iron 24개
- **결론**: ✅ 충분 (ore_iron이 병목이지만 여력 있음)

---

## 🎮 6. 스테이지 구조

### 6.1 던전 웨이브 시스템

- **1판당 적 수**: 1마리 (순차 전투)
- **웨이브 없음**: 단일 적 처치 후 다음 적 선택
- **자동 전투**: 없음 (턴 버튼 수동 클릭)

### 6.2 평균 전투 시간 (수동 기준)

| 상황 | 턴 수 | 예상 시간 |
|-----|------|---------|
| Lv.1 vs 초록 슬라임 | 3~5턴 | 10~15초 |
| Lv.10 vs 수정 골렘 | 8~15턴 | 25~45초 |
| Lv.20 vs 마그마 골렘 | 15~25턴 | 45~75초 |
| Lv.30 vs 인페르노 드래곤 | 30~50턴 | 1.5~2.5분 |

> 💡 턴당 약 3초 (클릭 + 애니메이션)

---

## ⚠️ 7. 밸런스 이슈 요약

### 🚨 심각
1. **초록 슬라임 EXP 10000**: 테스트 값 → **10으로 수정 필요**
2. **오토 전투 미지원**: 후반 던전 피로도 높음

### ⚠️ 주의
3. **DEF 밸런스**: 0 vs 80 차이 1.5배 → 적절함
4. **SSR 성공률 60%**: 1000G 비용 대비 실패 부담
5. **화산 요새 레벨 갭**: Lv.18 → Lv.30 (12레벨 갭)

### 💡 권장 개선
6. ore_mythril 같은 고급 재료 → 시설 생산 추가 또는 별도 던전
7. 던전 골드 직접 드랍 고려 (현재 재료 판매 의존)


## 📊 1. 던전 시스템

### 1.1 던전 별 권장 레벨 및 난이도

| 던전명 | 권장 레벨 | 적 레벨 범위 | 적 HP 범위 | 특징 |
|--------|---------|-------------|-----------|------|
| 🌲 슬라임 숲 | 1 | 1~10 | 30~200 | 입문용, 기본 재료 |
| ❄️ 겨울 왕국 | 2 | 2~15 | 45~500 | 눈꽃 재료, 크리스마스 테마 |
| 💧 신비한 호수 | 3 | 4~15 | 50~300 | 물 속성, 정령 가루 |
| 💎 수정 동굴 | 5 | 5~12 | 80~400 | 광석, 마력 결정 |
| 🐻 짐승의 숲 | 12 | 8~15 | 100~800 | 가죽, 송곳니, 발톱 |
| 🌋 화산 요새 | 20 | 18~30 | 600~2000 | 화염 속성, 용 재료 |
| ☁️ 천공의 탑 | 25 | 23~28 | 800~1500 | 바람 속성, 드래곤 |

### 1.2 적 스탯 분포

| 적 이름 | 레벨 | HP | ATK | DEF | EXP |
|---------|-----|----|----|-----|-----|
| 초록 슬라임 | 1 | 30 | 5 | 1 | 10000 |
| 파랑 슬라임 | 3 | 50 | 8 | 2 | 20 |
| 킹 슬라임 | 10 | 200 | 20 | 5 | 100 |
| 수정 골렘 | 12 | 400 | 45 | 30 | 120 |
| 상처 입은 곰 | 15 | 800 | 60 | 40 | 300 |
| 마그마 골렘 | 22 | 1000 | 80 | 60 | 400 |
| 인페르노 드래곤 | 30 | 2000 | 150 | 80 | 1000 |

> ⚠️ 초록 슬라임의 EXP 10000은 테스트용 수치로 보임 (확인 필요)

---

## 🏭 2. 시설 시스템

### 2.1 약초 농장

| 레벨 | 이름 | 생산 간격 | 주요 드랍 | 업그레이드 비용 |
|-----|------|---------|----------|--------------|
| 1 | 야생 들판 | 10초 | herb_common (100%) | 100 Gold |
| 2 | 약초 정원 | 8초 | common 80%, rare 20% | 250 Gold + 50 herb_common |
| 3 | 유리 온실 | 6초 | rare 70%, special 30% | 1,000 Gold + 50 herb_rare |
| 4 | 신비의 숲 | 5초 | special 60%, mystic 40% | 5,000 Gold + 100 herb_special |
| 5 | 세계수의 둥지 | 4초 | mystic 80%, yggdrasil 20% | 20,000 Gold + 200 herb_mystic |

### 2.2 광산

| 레벨 | 이름 | 생산 간격 | 주요 드랍 | 업그레이드 비용 |
|-----|------|---------|----------|--------------|
| 1 | 암석 광산 | 15초 | stone 90%, ore_iron 10% | 200 Gold |
| 2 | 구리 광산 | 12초 | ore_copper 80% | 500 Gold + 50 stone |
| 3 | 철 광산 | 10초 | ore_iron 80% | 1,200 Gold + 100 ore_copper |
| 4 | 은 광산 | 8초 | ore_silver 80% | 3,000 Gold + 200 ore_iron |
| 5 | 금 광산 | 6초 | ore_gold 70% | 10,000 Gold + 200 ore_silver |
| 6 | 다이아몬드 광산 | 5초 | diamond 50%, platinum 40% | 50,000 Gold |

### 2.3 대장간

| 레벨 | 이름 | 생산 간격 | 주요 생산 | 업그레이드 비용 |
|-----|------|---------|---------|--------------|
| 1 | 야외 화덕 | 20초 | ingot_copper 100% | 500 Gold |
| 2 | 마을 대장간 | 18초 | ingot_iron 90% | 2,000 Gold |
| 3 | 전문 제련소 | 15초 | ingot_silver 80% | 10,000 Gold |
| 4 | 왕실 대장간 | 12초 | ingot_gold 70% | 50,000 Gold |
| 5 | 전설의 용광로 | 10초 | ingot_platinum 60% | 200,000 Gold |

---

## 🧪 3. 연금술 시스템

### 3.1 레시피 등급별 통계

| 레어리티 | 필요 레벨 | 제작 시간 | 골드 비용 | 경험치 | 성공률 |
|---------|---------|---------|---------|--------|--------|
| N (일반) | 1~2 | 2~5초 | 10~50 | 10~20 | 90% |
| R (레어) | 2~4 | 5~10초 | 50~150 | 25~40 | 90% |
| SR (에픽) | 4~6 | 10~20초 | 150~500 | 50~120 | 75~90% |
| SSR (레전드) | 8+ | 60초 | 1000 | 200 | 60% |

### 3.2 주요 레시피 정보

| 레시피 | 결과물 | 필요 레벨 | 비용 | 경험치 | 주요 재료 |
|-------|-------|---------|------|--------|---------|
| 기본 슬라임 | monster_slime_basic | 1 | 10G | 10 | herb_common x2 |
| 송곳니 하운드 | monster_hound_fang | 2 | 50G | 20 | beast_fang x2, scrap_leather x1 |
| 돌 골렘 | monster_golem_stone | 3 | 100G | 30 | stone x10, ore_iron x1 |
| 왕슬라임 | monster_slime_king | 3 | 200G | 50 | slime_gel x10, slime_core x5, crown_fragment x1 |
| 인페르노 드래곤 | monster_dragon_inferno | 8 | 1000G | 200 | dragon_scale x1, ore_mythril x5, fire_core x3 |

### 3.3 연금술 레벨 성장

- **경험치 공식**: 레벨 = floor(total_exp / 100) + 1
- **연금술 실패 시**: 기본 경험치의 10% 획득 (최소 1)
- **연속 실패 3회 시**: 힌트 시스템 활성화

---

## ⚔️ 4. 전투 시스템

### 4.1 몬스터 스탯 성장

```
스탯 = 기본값 × (1 + (레벨 - 1) × 0.1)
```

예시 (기본 슬라임, 기본 HP=150):
- Lv.1: 150 HP
- Lv.5: 210 HP (+40%)
- Lv.10: 285 HP (+90%)
- Lv.20: 435 HP (+190%)

### 4.2 데미지 계산

```typescript
damage = calculateDamage(attacker, defender, powerMultiplier)
// 속성 상성, 크리티컬, 방어력 반영
```

### 4.3 스킬 발동

- **발동 확률**: 30%
- **스킬 타입**: DAMAGE, HEAL, BUFF, DEBUFF, SPECIAL
- **스킬 해금**: 레벨업 시 역할(Role) 기반으로 자동 해금

---

## 💰 5. 재화 밸런스

### 5.1 골드 획득원

| 출처 | 획득량 | 비고 |
|-----|-------|------|
| 재료 판매 | 1~5000G | 등급별 차등 |
| 던전 보상 | - | 직접 골드 드랍 없음 |

### 5.2 골드 소비처

| 용도 | 비용 범위 |
|-----|---------|
| 연금술 제작 | 10~1000G |
| 시설 업그레이드 | 100~200,000G |
| 몬스터 농장 | 100~1,500G |

### 5.3 재료 판매가 (예시)

| 재료 | 판매가 |
|-----|-------|
| herb_common | 10G |
| herb_rare | 50G |
| ore_iron | 15G |
| ore_gold | 120G |
| diamond | 5,000G |
| ingot_platinum | 3,000G |

---

## 📈 6. 성장 곡선 분석

### 6.1 초반 (Lv.1~5)

- **추천 던전**: 슬라임 숲, 겨울 왕국
- **주요 활동**: 약초 농장/광산 업그레이드, 기본 몬스터 제작
- **병목 자원**: herb_common, stone, ore_iron

### 6.2 중반 (Lv.5~15)

- **추천 던전**: 수정 동굴, 짐승의 숲
- **주요 활동**: 대장간 해금, R/SR 몬스터 제작
- **병목 자원**: ore_silver, gem_fragment, crystal_mana

### 6.3 후반 (Lv.15+)

- **추천 던전**: 화산 요새, 천공의 탑
- **주요 활동**: SSR 몬스터 제작, 상위 시설 업그레이드
- **병목 자원**: dragon_scale, fire_core, ore_mythril

---

## ⚠️ 밸런스 이슈 및 권장 조정

1. **초록 슬라임 EXP 10000**: 다른 몬스터 대비 비정상적으로 높음 → 10~20으로 조정 권장
2. **SSR 레시피 성공률 60%**: 고비용 대비 실패 위험 높음 → 70~75%로 조정 고려
3. **화산 요새 레벨 갭**: 권장 Lv.20 → 인페르노 드래곤 Lv.30 (레벨 갭 10) → 중간 적 추가 권장
