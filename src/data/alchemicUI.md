# 몬스터 연금술 공방 UI & 애니메이션 설계서

> 버전: v0.1  
> 대상: Vite + React + TypeScript + Canvas(연출) + Zustand 상태관리

---

## 1. 목적

- 몬스터를 **재료 조합**으로 생성하는 “연금술 공방” 화면을 설계한다.
- 몬스터는 **전투 스펙 + 공장(Production) 버프**를 동시에 가진 리소스로 취급한다.
- 유저가:
  - 어떤 몬스터를 만들지 선택하고,
  - 재료를 넣고,
  - 특수 조건(시간대/촉매/언어 등)을 확인하고,
  - 연출을 통해 “성공/실패”를 직관적으로 느끼도록 하는 것이 목표.

---

## 2. 화면 전체 구조

### 2.1 레이아웃 개요

    ┌───────────────────────────────────────────────┐
    │ [상단 헤더] 몬스터 연금술 공방 / 레벨 / 버프 요약 │
    ├───────────────┬───────────────┬───────────────┤
    │ ① 레시피/도감 │ ② 연금솥 & 조합 │ ③ 인벤토리/상세 │
    └───────────────┴───────────────┴───────────────┘

- **좌측(①)**: 레시피 목록 / 몬스터 도감 / 추천 조합 탭
- **중앙(②)**: 연금솥, 재료 슬롯, 특수 조건, 성공률/비용/시간, 조합 버튼
- **우측(③)**: 재료 인벤토리, 완성 몬스터 목록, 선택 대상 상세 정보

### 2.2 반응형 구조

- PC: 3열 구조 유지
- 태블릿/모바일:
  - ①, ③ 영역을 상단 탭으로 전환
  - 중앙 ②를 항상 화면 중앙에 유지

---

## 3. 상단 헤더 영역

### 3.1 표시 요소

- 화면 제목: `몬스터 연금술 공방`
- 공방 레벨: `공방 Lv. 3`
- 자원 요약:
  - `Gold`, `크리스탈` 등 통화
- 공방 버프 요약:
  - 연금 성공률/시간 등 글로벌 버프
  - 예: `성공률 +5%`, `제작 시간 -10%`

### 3.2 헤더 애니메이션

- 화면 진입 시:
  - 상단에서 아래로 슬라이드 + 페이드 인 (약 300ms, ease-out)
- 공방 레벨 업 시:
  - 레벨 텍스트 주변에 짧은 황금 링 파동 이펙트
  - 텍스트 scale 1.0 → 1.1 → 1.0 (약 150ms) + 색상 하이라이트

---

## 4. 좌측 패널 – 레시피 / 몬스터 도감 (①)

### 4.1 탭 구성

- `레시피`
  - 발견/미발견 레시피 목록
- `몬스터 도감`
  - 한 번 이상 조합에 성공한 몬스터 목록
- (선택) `추천 조합`
  - 현재 인벤토리 기준 추천 레시피 목록

### 4.2 레시피 카드 구조

각 레시피는 카드 단위로 표현:

- 아이콘
- 이름 + 등급 (예: `젤리 슬라임 (E)`)
- 역할 태그 (탱커/딜러/힐러/생산보너스 등)
- 필요한 재료 요약 (필요 수량 / 보유 수량)
- 버튼:
  - `선택`
  - 재료가 충분할 경우 `바로 조합`

### 4.3 레시피 리스트 상호작용

- 상단 필터/검색:
  - 역할 필터: `전체 / 탱커 / 딜러 / 힐러 / 생산`
  - 등급 필터: `E / D / C / ...`
  - 검색: 이름, 태그 기반
- 레시피 카드 클릭:
  - 중앙 연금솥 패널에 레시피 정보 전달
- 마우스 오버:
  - 카드 약간 확대 (scale 1.0 → 1.03, 150ms)
  - 그림자 강도 증가

### 4.4 레시피 리스트 애니메이션

- 리스트 진입:
  - 필터/검색 UI 먼저 페이드 인
  - 이후 카드가 아래에서 위로 순차 슬라이드 인 (각 50ms 간격)
- 레시피 선택:
  - 선택 카드에 좌측 포커스 바가 width 0 → 4px로 확장 (150ms)
  - 배경 색상이 살짝 밝아짐 (150ms)
  - 중앙 레시피 헤더는 크로스 페이드로 전환 (약 200ms)

---

## 5. 중앙 패널 – 연금솥 & 조합 영역 (②)

### 5.1 요소 구성

1. 선택된 레시피 헤더
2. 연금솥 영역 (Canvas + 재료 슬롯)
3. 특수 조건 영역
4. 성공률/비용/시간 영역
5. 조합 컨트롤 버튼

---

### 5.2 선택된 레시피 헤더

- 몬스터 이름 / 등급 / 역할
- 필요 재료 + 보유 수량 (예: `슬라임 코어 3 / 보유 7`)
- 조합 성공 시:
  - 생성 몬스터 수량
  - 연금 경험치 획득량

헤더 전환 애니메이션:

- 기존 정보: 위로 슬라이드 아웃 + 페이드 아웃 (150ms)
- 신규 정보: 아래에서 슬라이드 인 + 페이드 인 (150ms, 약간 겹치게 적용)

---

### 5.3 연금솥 & 재료 슬롯 영역

- 중앙에 연금솥 메인 일러스트
- 주변에 재료 슬롯(원형/사각형 슬롯):

  - 슬롯 내용:
    - 재료 아이콘
    - 현재 넣은 수량
    - 부족 시 붉은 테두리 + 경고 표시

- 상호작용:

  - 우측 인벤토리에서 드래그 & 드롭
  - 인벤토리에서 클릭 시: 자동으로 비어 있는 슬롯에 할당

#### 재료 드래그 & 드롭 애니메이션

- 드래그 시작:
  - 재료 아이콘 scale 1.0 → 1.05
  - 그림자 강화
- 드래그 중:
  - 아이콘 아래 연한 그림자 원으로 떠 있는 느낌
- 슬롯 위 hover:
  - 슬롯 테두리가 하이라이트 색으로 빛남 (glow + scale 1.0 → 1.03)
- 드롭 성공:
  - 슬롯 안 아이콘이 살짝 튀었다가 자리잡음 (scale 0.95 → 1.0, 100ms)
- 드롭 실패:
  - 아이콘이 좌우로 2~3px 정도 짧게 흔들리고 원위치 (100ms)

#### 재료 부족 표현

- 슬롯 테두리 색상이 천천히 붉은색으로 변화 (200ms)
- 약한 펄스 효과:
  - opacity 1.0 → 0.7 → 1.0 반복 (느리게)
- 조합 버튼에 마우스를 올렸을 때:
  - 버튼 아래에 `"슬라임 코어가 1개 부족합니다"` 같은 안내가 슬라이드 인

---

### 5.4 특수 조건 영역

특수 몬스터/강화 조합을 위한 조건을 표시:

- 시간대 조건:
  - 예: `현재 시간: 밤 (특수 레시피 발동 가능)`
- 언어/서버 조건:
  - 예: `현재 접속 언어: 한국어`
- 촉매 슬롯:
  - 기본 레시피 + 촉매 추가 시 상위 몬스터 레시피로 변형

표시 예시:

- `[시간대] 낮 / 밤 / 이벤트 (현재: 밤)`
- `[촉매 슬롯] 비어 있음` (특수 재료 드롭 시 활성화)
- `[언어 조건] 한국어 서버 (특수 레시피 ON/OFF 표시)`

특수 조건이 모두 충족되면:

- 아이콘에 빛나는 테두리 + 작은 별 파티클
- `특수 레시피 발동 가능` 텍스트 페이드 인
- 레시피 이름에 짧은 그라디언트 스캔 효과

---

### 5.5 성공률 / 비용 / 시간 영역

- `성공 확률: 85%`
- `소모 골드: 100`
- `소요 시간: 10초` (또는 즉시완료)

툴팁에 수치 출처 표시:

- 기본 성공률:
  - `기본 70%`
- 공방 레벨 보너스:
  - `+10%`
- 공장/몬스터 배치 보너스:
  - `허수아비 +3%`
  - `페어리 힐러(연금 연구소 배치) +5%` 등

---

### 5.6 조합 컨트롤

- `자동 배치` 버튼:
  - 현재 레시피에 필요한 재료를 인벤토리에서 자동으로 슬롯 채움
- `조합` 버튼:
  - 재료 부족 시 비활성화 + 툴팁 안내
- (옵션) `연속 조합 xN`:
  - 재료가 충분할 경우 여러 번 연속 조합

버튼 클릭 애니메이션:

- 클릭 시 버튼 scale 1.0 → 0.97 → 1.0 (짧게)
- 버튼 주변에 작은 원형 빛 파동 효과 (150ms)

---

## 6. 우측 패널 – 인벤토리 & 상세 정보 (③)

### 6.1 탭 구성

- `재료`
  - 재료 인벤토리 그리드/리스트 뷰
- `몬스터`
  - 보유 몬스터, 공장 배치 상태
- `공장 배치`
  - 어떤 몬스터가 어느 공장에 배치되어 있는지 요약

### 6.2 재료 인벤토리

재료 카드 내용:

- 아이콘
- 이름
- 보유 수량
- 출처 요약 (던전/공장 등)

상호작용:

- 클릭:
  - 중앙 재료 슬롯에 1개 추가
- 숫자/Shift 조합으로 여러 개 추가(향후 확장용)
- 드래그:
  - 연금솥 재료 슬롯으로 이동 가능

애니메이션:

- 인벤토리 진입:
  - 카드들이 `fade-in + scale 0.95 → 1.0` (staggered)
- 선택된 재료:
  - 카드 테두리에 하이라이트 색 적용

### 6.3 몬스터 인벤토리

- 보유 몬스터 목록:
  - 이름, 등급, 레벨, 수량
  - 공장 배치 여부 표시 (예: `2마리 공장 배치 중`)
- 선택 시:
  - 하단 상세 패널에 스탯/스킬/공장 특성 표시

### 6.4 상세 정보 패널

선택된 대상(재료/몬스터)에 따라 표시:

- 재료:
  - 설명
  - 사용되는 주요 레시피 목록(일부)
  - 획득처
- 몬스터:
  - 스탯
  - 스킬 목록
  - 공장 특성(factoryTrait) 요약
    - 예:
      - `우든 가디언`
      - 역할: 탱커 / 목재소 생산 +10%
      - 스킬: 목질 방어, 숲의 수호자
      - 공장 보너스: `LUMBER_MILL – 나무 생산량 +10%`

---

## 7. 상호작용 플로우

### 7.1 기본 조합 플로우

1. 좌측 패널에서 레시피 선택
2. 중앙 패널에 레시피 헤더 및 재료 슬롯 정보 업데이트
3. `자동 배치` 버튼 클릭 또는 우측 인벤토리에서 수동 배치
4. 성공률/비용/시간 확인
5. `조합` 버튼 클릭
6. 연금 애니메이션 진행
7. 결과 팝업 표시:
   - 성공: 몬스터 획득 + “공장에 배치하러 가기” 버튼
   - 실패: 실패 이펙트 + 재료 소실/반환 정보

### 7.2 특수 조합 플로우

1. 레시피 선택
2. 특수 조건 영역에서 현재 시간/언어/이벤트 조건 확인
3. 촉매 슬롯에 특수 재료를 드롭
4. 레시피 헤더가 상위 몬스터 레시피로 변경
5. 성공률/비용 재계산
6. 조합 실행 → 상위 몬스터 전용 연출

### 7.3 공장 배치 연동 플로우

- 연금 결과 팝업에서 `[공장에 배치하러 가기]` 클릭 시:
  - 연금 공방 화면이 살짝 축소되며 페이드 아웃
  - 공장 배치 화면이 우측에서 슬라이드 인
  - 새로 얻은 몬스터 카드가 연금솥에서 공장 화면으로 곡선 경로로 날아가는 연출

---

## 8. 애니메이션 & 연출 규칙

### 8.1 전역 모션 규칙

- 기본 duration: 150ms ~ 250ms
- 주요 액션(연금, 결과): 250ms ~ 600ms
- easing:
  - 진입/완료: ease-out
  - 상태 전환: ease-in-out
- 목적:
  - 정보 전달과 피드백 강화
  - 과도한 모션은 피하고, 조작과 결과에 집중

### 8.2 화면 진입

- 배경:
  - 중앙 그라디언트 opacity 0 → 1 (300ms)
- 좌/우 패널:
  - 양 옆에서 슬라이드 인 (250ms, 50ms 딜레이)
- 중앙 연금솥:
  - scale 0.9 → 1.0
  - opacity 0 → 1 (250ms)

### 8.3 연금 조합 애니메이션

조합 시작:

1. `조합` 버튼:
   - scale 1.0 → 0.97 → 1.0
   - 버튼 주변 작은 빛 파동
2. 연금솥:
   - 몸체 살짝 좌우로 흔들림 (1~2도, 2~3회)
   - 솥 안 액체:
     - 버블 파티클(거품) 위로 올라감
     - 레시피/등급에 따라 액체 색상 변경
   - 솥 위:
     - 연기/마법 기체 파티클 천천히 상승

진행 표시:

- 솥 아래/위에 원형 또는 막대형 진행 바
- AlchemyState.timeSec에 비례해 0 → 100% 진행

### 8.4 연금 성공 이펙트

- 진행 완료 시:

1. 솥 안에서 밝은 빛 플래시
2. 솥 뚜껑이 살짝 위로 튕겼다가 원위치
3. 몬스터 아이콘 카드가 솥 위에서 떠오름:
   - scale 0.0 → 1.05 → 1.0 (약 250ms)
   - 주위로 작은 빛 파티클 분산
4. 결과 팝업:
   - `"젤리 슬라임 x1 획득!"` 텍스트가 아래에서 슬라이드 업 + 페이드 인
   - 버튼: `[확인]`, `[공장에 배치하러 가기]`

### 8.5 연금 실패 이펙트

- 진행 완료 시:

1. 솥 안 액체 색이 어둡게 변함 (회색/보라 계열)
2. 거품이 거칠게 터지는 연출
3. 짧은 검은 연기 파티클가 솥 위로 튀어나왔다 사라짐
4. 화면 또는 솥 영역이 짧게 흔들림 (80~120ms)
5. 실패 메시지:
   - `"연금에 실패했습니다..."` 페이드 인
   - 소실/반환 재료 요약이 아래에서 슬라이드 다운

---

### 8.6 몬스터 도감 업데이트 연출

- 특정 몬스터를 처음 획득했을 때:

1. 도감 탭 아이콘에 작은 노란 뱃지 표시
2. 도감 내부:
   - 새 몬스터 카드 테두리에 하이라이트
   - 좌→우로 한 번 스캔하는 빛 효과
3. 미니 팝업:
   - `"새 몬스터가 도감에 등록되었습니다."`  
     우측 상단 등에서 3초 정도 표시 후 자동 사라짐

---

## 9. 상태/데이터 구조 참고

실제 구현 시 참고용 TS 타입 스케치:

    type AlchemyState = {
      selectedRecipeId: string | null;
      selectedIngredients: Record<string, number>; // materialId -> count
      catalystId: string | null;
      successRate: number;
      costGold: number;
      timeSec: number;
      isBrewing: boolean;
      progress: number; // 0~1
      result:
        | { type: 'idle' }
        | { type: 'success'; monsterId: string; count: number }
        | { type: 'fail'; lostMaterials: Record<string, number> };
    };

    type FactoryBuffSummary = {
      successRateBonus: number; // 성공률 보정
      timeReduction: number;    // 제작 시간 단축 비율
      expBonus: number;         // 연금 EXP 보너스
    };

필요 주요 데이터:

- recipes: 레시피 목록
- materials: 재료 인벤토리
- monsters: 몬스터 인벤토리
- factoryBuffs: 공장/몬스터 배치에서 계산된 연금 관련 버프 요약

---

## 10. 구현 우선순위

1. 기본 UI 레이아웃 (헤더 + 3열 구조)
2. 레시피 선택 → 중앙 패널 반영
3. 재료 선택/자동 배치 + 성공률/비용 계산 로직
4. `isBrewing` 상태 + 단순 진행 바 구현
5. 성공/실패 기본 연출 (색상/scale/fade 위주)
6. Canvas 기반 버블/빛/연기 파티클 이펙트 추가
7. 특수 조건(시간/촉매/언어) 로직 및 UI 반영
8. 공장 배치 화면과의 연동 트랜지션 추가

---

## 11. 향후 확장 아이디어

- 등급/속성에 따른 연금 이펙트 컬러/패턴 자동 변경
- 희귀/레전더리 연금 성공 시 전용 연출 (화면 전체 라이트닝, 로고 등장 등)
- 연금 기록/로그 탭 추가 (레시피별 시도/성공/실패 통계)
- 멀티 큐(여러 연금 슬롯) 도입:
  - 각 슬롯을 축소 카드 + 진행 바 형태로 화면 하단에 배치
- 연금 자동 반복 옵션:
  - 재료/골드 한도 내에서 자동 연속 조합

---
